
<!doctype html>
<html lang="kr">

<head>
  <meta charset="UTF-8">
  <title>login</title>

</head>
<body>

    <h1>이메일 인증</h1>
    
    {% if error %}
    <p id='error'>{{error}}</p>
    <br>
    {% endif %}
          <form method="POST" action="{% url 'approve'%}" name='submitForm'>
              {% csrf_token %}
              <input type="hidden" id='tmp' name="flag" value='{{judge}}'>
              <input type="hidden" id='time' name="time" value='{{left_time}}'>
             인증번호 <input type="text" name="ssn"  placeholder="Your ssn">
             <input type="submit" value="인증" >
        </form>
        <div id="timerTxt"></div>

        <script type="text/javascript">

          var timerId;
          var timerSec = 180;
          
        
          
            window.onload= function() {
      
            timerId = setInterval('timer()', 1000);
      
          }
      
          
      
          function timer() {
            if ((document.getElementById("error").innerHTML =='인증번호가 틀립니다.' )&&(document.getElementById("tmp").value == 'False')){
            timerSec=document.getElementById("time").value;
            
          } 
      
            var min = Math.floor(timerSec / 60)
      
            var sec = timerSec % 60;
      
            
      
            var msg = (min < 10 ? "0"+ min : min) + ":" + (sec < 10 ? "0"+ sec : sec);
      
            timerSec--;

            document.getElementById("time").value--
            
      
            if (timerSec < 0) { /* time End*/
      
              msg += "<br>Timer End!"
      
              clearInterval(timerId);
              document.getElementById("tmp").value ='True';
                
              document.submitForm.submit()
      
            }
      
            
      
            document.getElementById("timerTxt").innerHTML = msg;
      
            
      
          }
      
        </script>
      
      
      
     
</body>

