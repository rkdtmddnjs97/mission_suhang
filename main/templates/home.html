<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <!-- bootstrap css -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
</head>
<body>
    <!-- bootstrap js -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>

        {% load staticfiles %}
        <div class="box" href="{% url 'home' %}"><img class="image" src="{% static '진짜.png' %}" width="750px"></div>


<div class="pont">
<br>
{% if judge == True %}
<a href="{% url 'dissatisfication'%}">민원사항</a>
{% endif %}
<br>
<a href="{% url 'board'%}">자유게시판</a>
<br>
<a href="{% url 'request'%}">의뢰게시판</a>


<br>
<a href="{% url 'announcement_board' %}">공지사항</a>
<br>
<p>최근 공지사항</p>
{% for announcemnt in recent_announcements %}
<a href="{% url 'announcement_detail' announcemnt.id %}">{{announcemnt.title}}</a>
{% endfor %}
<br>




<form name="search_bar" action="{% url 'search' %}" method="GET" onsubmit="return check()" >      
        <span class="search_menu">
            <input type = "checkbox" name = "input_board" value = "freeboard" id = tag_box >자유 게시판<br>
            <input type = "checkbox" name = "input_board" value = "missionboard" id = tag_box >의뢰 게시판<br>
        </span>
        <span class="search_menu">
                <select class="form-control"  name ="input_type" >
                  <option name="input_type" value ="title" selected>title</option>
                  <option name="input_type" value ="hashtag">hashtag</option>
                  <option name="input_type" value ="writer">writer</option>
                  <option name="input_type" value ="body">Context</option>
                </select>
        </span>
            <input type="text" name='input_data' style=" all:unset; font-size: 1.5rem; width: 330px; border-bottom: #ffffff 2px solid;  margin: 0 0 0 10px ;" placeholder="Search" class="holder">
        <button type='submit' class='sch_smit' id='search_submit'><img class="image" src="{% static 'search.png' %}" width="37px;"></button>

    </form>




<!-- 미션을 많이 수행한 top3 수행자 닉네임 표시 -->
<span>Hot 수행자 : </span>
{% for hot_user in hot_users %}

    <a href="{% url 'profile' hot_user.profile_id %}">{{hot_user.profile_id}}</a>

    {% endfor %}
<br><br>
<!-- 인기 게시글과 hot 의뢰글 -->
<!-- 
<span>인기 게시판</span>
  {% for liked in like_lists %} 
    {% for entry in liked %}
        {% if forloop.counter0 == 0 %}
        <a href="{% url 'b_detail' entry.id %}">{{entry.title}}</a>:
         {% else %}
           {{entry}}
        {% endif %}
    {% endfor %}  
  {% endfor %}
<br>
<span>HOT 의뢰  </span>
{% for liked in scrap_lists %} 
   {% for entry in liked %}
      {% if forloop.counter0 == 0 %}
      <a href="{% url 'detail' entry.id %}">{{entry.title}}</a>
  
       {% else %}
         {{entry}}
      {% endif %}
    {% endfor %}  
{% endfor %}
<br>
<br><br>  -->

<!-- 해당 시스템 총 미션수행완료 갯수 표시 -->
<p>현재 완료된 미션수행은 {{mission_completed}}건 입니다.</p>

<!-- 최근 올라온 의뢰글 표시 -->
<p>진행되지 않은 의뢰는 {{ready_number}}건 입니다.</p>

<p>현재 진행 중인 의뢰는 {{running_number}}건 입니다.</p>

<span>최신 의뢰</span><br>
{% for recent_post in recent_posts %}
    
    <a href="{% url 'detail' recent_post.id%}">{{recent_post.title}}</a><br>
   
{% endfor %}
<br>

<!-- 해시태그 정보 참고하여 추천 의뢰물 표시-->
<p>추천 의뢰</p>
{% for tag, posts in recommend_post.items %}
    #{{tag}}와 관련된 게시물
    {% for post in posts %}
    <a href="{% url 'detail' post.id %}">{{post}}</a>
    {% endfor %}
    <br>
{% endfor %}

<!--  뿌야-->
{% if not user.is_authenticated or  request.user.profile.approval == False and request.user.is_superuser == False%}
<a class="nav-link" href="{% url 'login' %}">Login</a>
<a class="nav-link" href="{% url 'signup' %}">Signup</a>
{% else %}
{% if request.user.profile.approval == True or request.user.is_superuser == True %}
<a id="logout_btn">
<form method="POST" action="{% url 'logout' %}">
    {% csrf_token %}
    <input style="all:unset; color: rgb(0, 0, 0);" type="submit" value="Logout" >
</form>
</a>
{% if request.user.is_superuser == False %}
<a href="{% url 'profile' user.profile.profile_id %}">Mypage (
    {{user.username}} ) </a>

{% endif %}

<a href="#" rel="popover" data-trigger="focus" data-placement="bottom"
    data-popover-content="#list-popover">알림({{notifi_count}})</a>
<div id="list-popover" style="display:none">
    <a class="ul-popover">
        {% for notification in notification_list %}
            {% if notification.notification_type == 'comment' %}
               <a href="{% url 'detail' notification.notifi_post_id.id %}">{{notification.creator}}가 {{notification.notification_type}}하였습니다.</a><br>
            {% else %}
              <a>{{notification.creator}}가 {{notification.notification_type}}하였습니다.</a><br>
            {% endif %}
        {% endfor %}
        <a href="{% url 'notifications' %}">see all</a>
    </a> 






{% endif %}
{% endif %}



<div style="position: fixed; bottom:5px; right:5px;"><a href="#"><img class="top" src="{% static 'top.png' %}" width="50px;"></a>
</div>
<script type="text/javascript">

    $('.result_tag').hide();

    $('[rel="popover"]').popover({
        container: 'body',
        html: true,
        content: function () {
            var clone = $($(this).data('popover-content')).clone(true).html();
            return clone;
        }
    }).click(function (e) {
        e.preventDefault();
    });

    $('[rel="popover_like"]').popover({
        container: 'body',
        html: true,
        content: function () {
            var clone = $($(this).data('popover-content')).clone(true).html();
            return clone;
        }
    }).click(function (e) {
        e.preventDefault();
    });

    $('[rel="popover_scrap"]').popover({
        container: 'body',
        html: true,
        content: function () {
            var clone = $($(this).data('popover-content')).clone(true).html();
            return clone;
        }
    }).click(function (e) {
        e.preventDefault();
    });

    function check() {
        var chkbox = document.getElementsByName('input_board');
        var chk = true;
        for(var i=0; i<chkbox.length; i++) {
            if(chkbox[i].checked) { pass }
            else { chk = false; }
        }
        if (chk == false) {
            alert("검색 할 게시판을 선택해주세요!");
            return false;
        }
        else { return true; }
    }

    jQuery(function($) {
        $('#search_tag').keyup(function(event) {
            var val = $(this).val();
            if (val == "") {
                $('.result_tag').hide();
            } else {
                $('.result_tag').hide();
                $(".result_tag:contains('"+val+"')").show();
            }
        });
    });

    function input_hashtag(val){
        var tag = "#"+val;
        tag = $('#new_hashtag').val() + tag;
        $('#new_hashtag').val(tag);
    }
</script>

</body>
</html>
<style>
 @import url('https://fonts.googleapis.com/css?family=Do+Hyeon&display=swap');
 .pont{
    font-family: 'Do Hyeon', sans-serif;
 }
 .box{
     text-align: center;
     margin: 5rem 0 0 0;
 }
 

</style>
